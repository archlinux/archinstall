on: [ push, pull_request ]
name: mypy type checking
jobs:
    mypy:
        runs-on: ubuntu-latest
        container:
            image: archlinux:latest
        steps:
            - uses: actions/checkout@v2
            - run: pacman --noconfirm -Syu python mypy python-pip
            - run: python -m pip install --upgrade pip
            - run: pip install fastapi pydantic
            - run: python --version
            - run: mypy --version
            # one day this will be enabled
              # run: mypy --strict --module archinstall || exit 0
            - name: run mypy
              run: mypy --follow-imports=silent
                  --exclude "archinstall/__main__.py"
                  --exclude "archinstall/lib/hardware.py"
                  --exclude "archinstall/lib/installer.py"
                  --exclude "archinstall/lib/pacman.py"
                  --exclude "archinstall/lib/exceptions.py"
                  --exclude "archinstall/lib/storage.py"
                  --exclude "archinstall/lib/packages/packages.py"
                  --exclude "archinstall/lib/packages/__init__.py"
                  --exclude "archinstall/lib/networking.py"
                  --exclude "archinstall/lib/mirrors.py"
                  --exclude "archinstall/lib/general.py"
                  --exclude "archinstall/lib/configuration.py"
                  --exclude "archinstall/lib/user_interaction/utils.py"
                  --exclude "archinstall/lib/user_interaction/backwards_compatible_conf.py"
                  --exclude "archinstall/lib/user_interaction/manage_users_conf.py"
                  --exclude "archinstall/lib/user_interaction/locale_conf.py"
                  --exclude "archinstall/lib/user_interaction/__init__.py"
                  --exclude "archinstall/lib/user_interaction/save_conf.py"
                  --exclude "archinstall/lib/user_interaction/system_conf.py"
                  --exclude "archinstall/lib/user_interaction/partitioning_conf.py"
                  --exclude "archinstall/lib/user_interaction/disk_conf.py"
                  --exclude "archinstall/lib/user_interaction/general_conf.py"
                  --exclude "archinstall/lib/plugins.py"
                  --exclude "archinstall/lib/disk/helpers.py"
                  --exclude "archinstall/lib/disk/btrfs/__init__.py"
                  --exclude "archinstall/lib/disk/btrfs/btrfspartition.py"
                  --exclude "archinstall/lib/disk/btrfs/btrfssubvolumeinfo.py"
                  --exclude "archinstall/lib/disk/mapperdev.py"
                  --exclude "archinstall/lib/disk/validators.py"
                  --exclude "archinstall/lib/disk/user_guides.py"
                  --exclude "archinstall/lib/disk/dmcryptdev.py"
                  --exclude "archinstall/lib/disk/partition.py"
                  --exclude "archinstall/lib/disk/__init__.py"
                  --exclude "archinstall/lib/disk/filesystem.py"
                  --exclude "archinstall/lib/locale_helpers.py"
                  --exclude "archinstall/lib/profiles.py"
                  --exclude "archinstall/lib/systemd.py"
                  --exclude "archinstall/lib/luks.py"
                  --exclude "archinstall/lib/udev/__init__.py"
                  --exclude "archinstall/lib/udev/udevadm.py"
                  --exclude "archinstall/lib/__init__.py"
                  --exclude "archinstall/lib/hsm/__init__.py"
                  --exclude "archinstall/lib/hsm/fido.py"
                  --exclude "archinstall/lib/output.py"
                  --exclude "archinstall/lib/menu/menu.py"
                  --exclude "archinstall/lib/menu/simple_menu.py"
                  --exclude "archinstall/lib/menu/__init__.py"
                  --exclude "archinstall/lib/menu/text_input.py"
                  --exclude "archinstall/lib/services.py"
                  --exclude "archinstall/lib/models/subvolume.py"
                  --exclude "archinstall/lib/models/password_strength.py"
                  --exclude "archinstall/lib/models/__init__.py"
                  --exclude "archinstall/lib/models/dataclasses.py"
                  --exclude "archinstall/lib/models/pydantic.py"
                  --exclude "archinstall/__init__.py"
                  --exclude "profiles/desktop.py"
                  --exclude "profiles/52-54-00-12-34-56.py"
                  --exclude "profiles/cinnamon.py"
                  --exclude "profiles/budgie.py"
                  --exclude "profiles/server.py"
                  --exclude "profiles/enlightenment.py"
                  --exclude "profiles/minimal.py"
                  --exclude "profiles/applications/pipewire.py"
                  --exclude "profiles/applications/tomcat.py"
                  --exclude "profiles/applications/httpd.py"
                  --exclude "profiles/applications/sshd.py"
                  --exclude "profiles/applications/postgresql.py"
                  --exclude "profiles/applications/mariadb.py"
                  --exclude "profiles/applications/lighttpd.py"
                  --exclude "profiles/applications/__init__.py"
                  --exclude "profiles/applications/nginx.py"
                  --exclude "profiles/applications/docker.py"
                  --exclude "profiles/applications/awesome.py"
                  --exclude "profiles/applications/cockpit.py"
                  --exclude "profiles/qtile.py"
                  --exclude "profiles/kde.py"
                  --exclude "profiles/cutefish.py"
                  --exclude "profiles/deepin.py"
                  --exclude "profiles/i3.py"
                  --exclude "profiles/bspwm.py"
                  --exclude "profiles/sway.py"
                  --exclude "profiles/xorg.py"
                  --exclude "profiles/__init__.py"
                  --exclude "profiles/gnome.py"
                  --exclude "profiles/awesome.py"
                  --exclude "profiles/lxqt.py"
                  --exclude "profiles/mate.py"
                  --exclude "profiles/xfce4.py"
                  --exclude "examples/unattended.py"
                  --exclude "examples/minimal.py"
                  --exclude "examples/guided.py"
                  --exclude "examples/__init__.py"
                  --exclude "examples/swiss.py"
                  --exclude "examples/only_hd.py"
                  archinstall/
                  profiles/
                  examples/
