on: [ push, pull_request ]
name: mypy type checking
jobs:
    mypy:
        runs-on: ubuntu-latest
        container:
            image: archlinux:latest
        steps:
            - uses: actions/checkout@v2
            - run: pacman --noconfirm -Syu python mypy python-pip
            - run: python -m pip install --upgrade pip
            - run: pip install fastapi pydantic
            - run: python --version
            - run: mypy --version
            - name: run mypy non-strict
              run: mypy --follow-imports=silent
                --exclude "archinstall/lib/disk/btrfs/btrfssubvolumeinfo.py"
                --exclude "archinstall/lib/disk/dmcryptdev.py"
                --exclude "archinstall/lib/disk/helpers.py"
                --exclude "archinstall/lib/disk/mapperdev.py"
                --exclude "archinstall/lib/general.py"
                --exclude "archinstall/lib/hardware.py"
                --exclude "archinstall/lib/menu/menu.py"
                --exclude "archinstall/lib/menu/simple_menu.py"
                --exclude "archinstall/lib/mirrors.py"
                --exclude "archinstall/lib/models/dataclasses.py"
                --exclude "archinstall/lib/models/pydantic.py"
                --exclude "archinstall/lib/models/subvolume.py"
                --exclude "archinstall/lib/networking.py"
                --exclude "archinstall/lib/pacman.py"
                --exclude "archinstall/lib/plugins.py"
                --exclude "archinstall/lib/profiles.py"
                --exclude "archinstall/lib/user_interaction/partitioning_conf.py"
                --exclude "archinstall/examples/guided.py"
                --exclude "archinstall/examples/only_hd.py"
                --exclude "archinstall/__init__.py"
                --exclude "archinstall/lib/configuration.py"
                --exclude "archinstall/lib/disk/btrfs/btrfspartition.py"
                --exclude "archinstall/lib/disk/btrfs/__init__.py"
                --exclude "archinstall/lib/disk/filesystem.py"
                --exclude "archinstall/lib/disk/partition.py"
                --exclude "archinstall/lib/disk/user_guides.py"
                --exclude "archinstall/lib/hsm/fido.py"
                --exclude "archinstall/lib/installer.py"
                --exclude "archinstall/lib/luks.py"
                --exclude "archinstall/lib/systemd.py"
                --exclude "archinstall/lib/user_interaction/backwards_compatible_conf.py"
                --exclude "archinstall/lib/user_interaction/disk_conf.py"
                --exclude "archinstall/lib/user_interaction/general_conf.py"
                --exclude "archinstall/lib/user_interaction/locale_conf.py"
                --exclude "archinstall/lib/user_interaction/manage_users_conf.py"
                --exclude "archinstall/lib/user_interaction/save_conf.py"
                --exclude "archinstall/lib/user_interaction/system_conf.py"
                --exclude "archinstall/__main__.py"
                --exclude "examples/guided.py"
                --exclude "examples/only_hd.py"
                archinstall/
                profiles/
                examples/
            - name: run mypy strict
              run: mypy --strict --follow-imports=silent
                --exclude "archinstall/lib/configuration.py"
                --exclude "archinstall/lib/disk/btrfs/btrfssubvolumeinfo.py"
                --exclude "archinstall/lib/disk/helpers.py"
                --exclude "archinstall/lib/hsm/fido.py"
                --exclude "archinstall/lib/menu/list_manager.py"
                --exclude "archinstall/lib/menu/menu.py"
                --exclude "archinstall/lib/menu/simple_menu.py"
                --exclude "archinstall/lib/menu/text_input.py"
                --exclude "archinstall/lib/models/dataclasses.py"
                --exclude "archinstall/lib/models/network_configuration.py"
                --exclude "archinstall/lib/models/password_strength.py"
                --exclude "archinstall/lib/models/pydantic.py"
                --exclude "archinstall/lib/models/subvolume.py"
                --exclude "archinstall/lib/models/users.py"
                --exclude "archinstall/lib/output.py"
                --exclude "archinstall/lib/plugins.py"
                --exclude "archinstall/examples/guided.py"
                --exclude "archinstall/examples/minimal.py"
                --exclude "archinstall/examples/only_hd.py"
                --exclude "archinstall/examples/swiss.py"
                --exclude "archinstall/__init__.py"
                --exclude "archinstall/lib/disk/blockdevice.py"
                --exclude "archinstall/lib/disk/btrfs/btrfs_helpers.py"
                --exclude "archinstall/lib/disk/btrfs/btrfspartition.py"
                --exclude "archinstall/lib/disk/btrfs/__init__.py"
                --exclude "archinstall/lib/disk/dmcryptdev.py"
                --exclude "archinstall/lib/disk/filesystem.py"
                --exclude "archinstall/lib/disk/mapperdev.py"
                --exclude "archinstall/lib/disk/partition.py"
                --exclude "archinstall/lib/disk/user_guides.py"
                --exclude "archinstall/lib/general.py"
                --exclude "archinstall/lib/hardware.py"
                --exclude "archinstall/lib/installer.py"
                --exclude "archinstall/lib/locale_helpers.py"
                --exclude "archinstall/lib/luks.py"
                --exclude "archinstall/lib/menu/global_menu.py"
                --exclude "archinstall/lib/menu/selection_menu.py"
                --exclude "archinstall/lib/mirrors.py"
                --exclude "archinstall/lib/networking.py"
                --exclude "archinstall/lib/packages/packages.py"
                --exclude "archinstall/lib/pacman.py"
                --exclude "archinstall/lib/profiles.py"
                --exclude "archinstall/lib/systemd.py"
                --exclude "archinstall/lib/translation.py"
                --exclude "archinstall/lib/user_interaction/backwards_compatible_conf.py"
                --exclude "archinstall/lib/user_interaction/disk_conf.py"
                --exclude "archinstall/lib/user_interaction/general_conf.py"
                --exclude "archinstall/lib/user_interaction/locale_conf.py"
                --exclude "archinstall/lib/user_interaction/manage_users_conf.py"
                --exclude "archinstall/lib/user_interaction/network_conf.py"
                --exclude "archinstall/lib/user_interaction/partitioning_conf.py"
                --exclude "archinstall/lib/user_interaction/save_conf.py"
                --exclude "archinstall/lib/user_interaction/system_conf.py"
                --exclude "archinstall/lib/user_interaction/utils.py"
                --exclude "archinstall/__main__.py"
                --exclude "archinstall/profiles/applications/pipewire.py"
                --exclude "archinstall/profiles/awesome.py"
                --exclude "archinstall/profiles/bspwm.py"
                --exclude "archinstall/profiles/budgie.py"
                --exclude "archinstall/profiles/cinnamon.py"
                --exclude "archinstall/profiles/cutefish.py"
                --exclude "archinstall/profiles/deepin.py"
                --exclude "archinstall/profiles/desktop.py"
                --exclude "archinstall/profiles/enlightenment.py"
                --exclude "archinstall/profiles/gnome.py"
                --exclude "archinstall/profiles/i3.py"
                --exclude "archinstall/profiles/kde.py"
                --exclude "archinstall/profiles/lxqt.py"
                --exclude "archinstall/profiles/mate.py"
                --exclude "archinstall/profiles/minimal.py"
                --exclude "archinstall/profiles/qtile.py"
                --exclude "archinstall/profiles/server.py"
                --exclude "archinstall/profiles/sway.py"
                --exclude "archinstall/profiles/xfce4.py"
                --exclude "archinstall/profiles/xorg.py"
                --exclude "profiles/applications/pipewire.py"
                --exclude "profiles/awesome.py"
                --exclude "profiles/bspwm.py"
                --exclude "profiles/budgie.py"
                --exclude "profiles/cinnamon.py"
                --exclude "profiles/cutefish.py"
                --exclude "profiles/deepin.py"
                --exclude "profiles/desktop.py"
                --exclude "profiles/enlightenment.py"
                --exclude "profiles/gnome.py"
                --exclude "profiles/i3.py"
                --exclude "profiles/kde.py"
                --exclude "profiles/lxqt.py"
                --exclude "profiles/mate.py"
                --exclude "profiles/minimal.py"
                --exclude "profiles/qtile.py"
                --exclude "profiles/server.py"
                --exclude "profiles/sway.py"
                --exclude "profiles/xfce4.py"
                --exclude "profiles/xorg.py"
                --exclude "examples/guided.py"
                --exclude "examples/only_hd.py"
                --exclude "examples/minimal.py"
                --exclude "examples/swiss.py"
                archinstall/
                profiles/
                examples/

